local player = game.Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")
local starterGui = game:GetService("StarterGui")

local function collectUIHierarchy(parent, path)
	local currentPath = path and (path .. " > " .. parent.Name) or parent.Name
	local uiList = {}

	for _, child in ipairs(parent:GetChildren()) do
		if child:IsA("GuiObject") or child:IsA("ScreenGui") then
			table.insert(uiList, currentPath .. " > " .. child.Name)
			local childUIList = collectUIHierarchy(child, currentPath)
			for _, subChild in ipairs(childUIList) do
				table.insert(uiList, subChild)
			end
		end
	end

	return uiList
end

local function displayUIHierarchy(uiString)
	-- Create a ScreenGui in PlayerGui to display the UI hierarchy
	local displayGui = Instance.new("ScreenGui")
	displayGui.Name = "UIHierarchyDisplay"
	displayGui.ResetOnSpawn = false
	displayGui.Parent = playerGui  -- This is in PlayerGui to make it visible to the player

	-- Create a ScrollingFrame with the specified position and size
	local scrollingFrame = Instance.new("ScrollingFrame")
	scrollingFrame.Size = UDim2.new(0, 361, 0, 268)
	scrollingFrame.Position = UDim2.new(0.311, 0, 0.239, 0)
	scrollingFrame.BackgroundTransparency = 0.3
	scrollingFrame.BackgroundColor3 = Color3.new(0, 0, 0)
	scrollingFrame.ScrollBarThickness = 12
	scrollingFrame.CanvasSize = UDim2.new(0, 0, 0, 0)  -- Initialize CanvasSize
	scrollingFrame.Parent = displayGui

	-- Create a TextLabel inside the ScrollingFrame with dynamic size based on content
	local textLabel = Instance.new("TextLabel")
	textLabel.Size = UDim2.new(1, 0, 0, 0)  -- Set initial size (1 wide, 0 height)
	textLabel.Position = UDim2.new(0, 0, 0, 0)
	textLabel.Text = uiString
	textLabel.TextScaled = false
	textLabel.BackgroundTransparency = 1  
	textLabel.TextColor3 = Color3.new(1, 1, 1)
	textLabel.TextYAlignment = Enum.TextYAlignment.Top  -- Align text to the top
	textLabel.Parent = scrollingFrame

	-- Resize the TextLabel and ScrollingFrame's CanvasSize based on the text size
	textLabel.Size = UDim2.new(1, 0, 0, textLabel.TextBounds.Y)
	scrollingFrame.CanvasSize = UDim2.new(0, 0, 0, textLabel.TextBounds.Y)
end

local function checkAndDisplay(parent)
	local uiList = collectUIHierarchy(parent)

	if #uiList > 0 then
		local uiString = table.concat(uiList, "\n")

		-- Display the collected UI hierarchy in the player's GUI
		displayUIHierarchy(uiString)
	end
end

wait(5)

-- Collect UI hierarchy from StarterGui and display it in PlayerGui
checkAndDisplay(starterGui)
